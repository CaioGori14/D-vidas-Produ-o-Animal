<script>
  const SUPABASE_URL = 'https://tjxommslunnfzaqpgvwp.supabase.co';
  const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRqeG9tbXNsdW5uZnphcXBndndwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMxMDc4MTEsImV4cCI6MjA2ODY4MzgxMX0.NLn-jiQfyOK3vJvBfdV611HKUzrBeDj-QsoWgQ9BMCM';
  const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  async function registrar() {
    const email = document.getElementById("email").value;
    const senha = document.getElementById("senha").value;
    const { error } = await supabase.auth.signUp({ email, password: senha });
    if (error) alert("Erro ao cadastrar: " + error.message);
    else alert("Cadastro realizado! Confirme seu e-mail.");
  }

  async function logar() {
    const email = document.getElementById("email").value;
    const senha = document.getElementById("senha").value;
    const { data, error } = await supabase.auth.signInWithPassword({ email, password: senha });
    if (error) alert("Erro ao entrar: " + error.message);
    else location.reload();
  }

  async function logout() {
    await supabase.auth.signOut();
    location.reload();
  }

  async function checkLogin() {
    const { data: { session } } = await supabase.auth.getSession();
    const area = document.getElementById("area-restrita");
    const loginForm = document.getElementById("form-login");
    const loginArea = document.getElementById("login-area");
    if (session) {
      area.style.display = "block";
      loginForm.style.display = "none";
      loginArea.innerHTML = '<a href="#" onclick="logout()">Sair</a>';
    }
  }

  checkLogin();

  // DICAS
  const dicas = [
    "🐄 A Embrapa atua desde 1973 com foco em inovação agropecuária para o Brasil.",
    "🌱 A FAO disponibiliza relatórios globais sobre sustentabilidade na pecuária.",
    "📘 O Repositório da UNESP contém mais de 30 mil trabalhos acadêmicos abertos.",
    "🌍 A base AGRIS reúne mais de 12 milhões de registros em agricultura e pecuária.",
    "🔍 O Google Scholar é uma ferramenta essencial para encontrar artigos científicos.",
    "📚 A SciELO hospeda revistas brasileiras avaliadas e indexadas internacionalmente."
  ];

  let dicaIndex = 0;
  function trocarDica() {
    const dicaEl = document.getElementById("dica-rodape");
    if (dicaEl) {
      dicaEl.textContent = dicas[dicaIndex];
      dicaIndex = (dicaIndex + 1) % dicas.length;
    }
  }

  // IMAGENS DE FUNDO
  const imagensFundo = [
    'https://images.pexels.com/photos/4911676/pexels-photo-4911676.jpeg',
    'https://images.pexels.com/photos/5088028/pexels-photo-5088028.jpeg',
    'https://images.pexels.com/photos/18794641/pexels-photo-18794641/free-photo-of-porcos-selvagens-na-grama.jpeg',
    'https://images.pexels.com/photos/5944199/pexels-photo-5944199.jpeg',
    'https://images.pexels.com/photos/4911681/pexels-photo-4911681.jpeg',
    'https://images.pexels.com/photos/4911664/pexels-photo-4911664.jpeg'
  ];
  let imagemIndex = 0;
  function trocarImagemFundo() {
    document.body.style.backgroundImage = `url(${imagensFundo[imagemIndex]})`;
    imagemIndex = (imagemIndex + 1) % imagensFundo.length;
  }

  // INICIALIZAÇÃO
  window.onload = () => {
    trocarImagemFundo();
    trocarDica();
    setInterval(trocarImagemFundo, 15000);
    setInterval(trocarDica, 10000);
  };
</script>
